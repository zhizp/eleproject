<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ele.project.sysmanager.menu.dao.MenuDao">
	<select id="getMenuListByUserId" resultType="java.util.Map" parameterType="Map">
		select distinct * from ERP_S_MENU bm start with bm.menu_id in(
                 select rm.menu_id from ERP_S_USERROLE t 
                 left join ERP_S_USER u on t.user_guid=u.guid
                 left join ERP_S_ROLETOMENU rm on t.role_id=rm.role_id 
                 where  u.logon_name=#{logon_name} )		
		<if test="parentid !=null">
			and bm.parentid=${parentid}
		</if>
		connect by prior  bm.parentid = bm.menu_id order by bm.displayorder
	</select>
</mapper>